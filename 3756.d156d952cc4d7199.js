"use strict";(self.webpackChunkintranet=self.webpackChunkintranet||[]).push([[3756],{3756:(at,u,_)=>{_.r(u),_.d(u,{CrmactivityComponent:()=>ot});var d=_(6814),c=_(1486),x=_(4456),m=_.n(x),g=_(9846),s=_(6223),h=_(1312),p=_(4227),Z=_(9246),t=_(9212),f=_(7372),T=_(2425),y=_(266),C=_(5633),v=_(5219);const b=()=>[d.sg,d.O5,d.H9,d.uU,s.YN,s.Kr,s.Fj,s.EJ,s.JJ,s.On,p.O],U=()=>[d.uU,s.Fj,s.JJ,s.On,Z.Y,v.jx,p.O],A=()=>[d.H9,v.jx,h.V];function M(i,a){1&i&&(t.TgZ(0,"div",51)(1,"ul",52)(2,"li",53)(3,"div",54),t._UZ(4,"p-skeleton",55),t.TgZ(5,"div",56),t._UZ(6,"p-skeleton",57)(7,"p-skeleton",58),t.qZA()()(),t.TgZ(8,"li",53)(9,"div",54),t._UZ(10,"p-skeleton",55),t.TgZ(11,"div",56),t._UZ(12,"p-skeleton",57)(13,"p-skeleton",58),t.qZA()()(),t.TgZ(14,"li",53)(15,"div",54),t._UZ(16,"p-skeleton",55),t.TgZ(17,"div",56),t._UZ(18,"p-skeleton",57)(19,"p-skeleton",58),t.qZA()()(),t.TgZ(20,"li")(21,"div",54),t._UZ(22,"p-skeleton",55),t.TgZ(23,"div",56),t._UZ(24,"p-skeleton",57)(25,"p-skeleton",58),t.qZA()()()()())}function q(i,a){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.start_time,"dd-MMM-yyyy"))}}function D(i,a){if(1&i&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"date"),t.ALo(3,"date"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.AsE("",t.xi3(2,2,e.start_time,"dd-MMM-yyyy hh:mm a")," - ",t.xi3(3,5,e.end_time,"dd-MMM-yyyy hh:mm a"),"")}}function O(i,a){if(1&i&&(t.TgZ(0,"div"),t._UZ(1,"i",63),t._uU(2),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.distributor1.toLocaleString("en-IN"))}}function w(i,a){if(1&i&&(t.TgZ(0,"div",64),t._UZ(1,"i",63),t._uU(2),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.distributor2.toLocaleString("en-IN"))}}function E(i,a){if(1&i&&(t.TgZ(0,"div"),t._UZ(1,"i",63),t._uU(2),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.Oqu((e.distributor1+e.distributor2).toLocaleString("en-IN"))}}function L(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",65)(1,"td",66),t._uU(2),t.qZA(),t.TgZ(3,"td",67)(4,"div"),t._uU(5),t.qZA()(),t.TgZ(6,"td",67),t.YNc(7,q,3,4,"div",68)(8,D,4,8,"div",68),t.qZA(),t.TgZ(9,"td",67)(10,"div")(11,"button",69),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.LoadActivity(r))}),t._uU(12),t.qZA()()(),t.TgZ(13,"td",67)(14,"div"),t._uU(15),t.qZA()(),t.TgZ(16,"td",67)(17,"div"),t._uU(18),t.ALo(19,"currency"),t.qZA()(),t.TgZ(20,"td",67),t.YNc(21,O,3,1,"div",68),t.qZA(),t.TgZ(22,"td",67),t.YNc(23,w,3,1,"div",70),t.qZA(),t.TgZ(24,"td",67),t.YNc(25,E,3,1,"div",68),t.qZA()()}if(2&i){const e=a.$implicit,o=a.index,n=t.oxw(3);t.xp6(2),t.hij(" ",o+1," "),t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Q6J("ngIf","Day"==n.condition),t.xp6(1),t.Q6J("ngIf","Time"==n.condition),t.xp6(4),t.Oqu(e.visit),t.xp6(3),t.Oqu(e.totalorders),t.xp6(3),t.Oqu(t.xi3(19,10,e.retail,"INR")),t.xp6(3),t.Q6J("ngIf",e.distributor1),t.xp6(2),t.Q6J("ngIf",e.distributor2),t.xp6(2),t.Q6J("ngIf",e.distributor1+e.distributor2>0)}}function P(i,a){if(1&i&&(t.TgZ(0,"table",59)(1,"thead")(2,"tr",60)(3,"th"),t._uU(4,"ID"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"EMPLOYEE NAME"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"DATE"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"TOTAL VISIT"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"TOTAL ORDERS"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"RETAIL SALE"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"PREORDER SALE"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"ORDER SALE"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"TOTAL DISTRIBUTOR"),t.qZA()()(),t.TgZ(21,"tbody"),t.YNc(22,L,26,13,"tr",61),t.qZA(),t.TgZ(23,"tfoot")(24,"tr",62),t._UZ(25,"td"),t.TgZ(26,"td"),t._uU(27,"Total"),t.qZA(),t._UZ(28,"td"),t.TgZ(29,"td"),t._uU(30),t.qZA(),t.TgZ(31,"td"),t._uU(32),t.qZA(),t.TgZ(33,"td"),t._UZ(34,"i",63),t._uU(35),t.qZA(),t.TgZ(36,"td"),t._UZ(37,"i",63),t._uU(38),t.qZA(),t.TgZ(39,"td",64),t._UZ(40,"i",63),t._uU(41),t.qZA(),t.TgZ(42,"td"),t._UZ(43,"i",63),t._uU(44),t.qZA()()()()),2&i){const e=t.oxw(2);t.xp6(22),t.Q6J("ngForOf",e.list),t.xp6(8),t.Oqu(e.totalvisit),t.xp6(2),t.Oqu(e.totalorders),t.xp6(3),t.Oqu(e.totalretail.toLocaleString("en-IN")),t.xp6(3),t.Oqu(e.totaldistributor.toLocaleString("en-IN")),t.xp6(3),t.Oqu(e.totaldistributor0.toLocaleString("en-IN")),t.xp6(3),t.Oqu((e.totaldistributor+e.totaldistributor0).toLocaleString("en-IN"))}}function k(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._uU(5," Overview "),t.qZA(),t.TgZ(6,"h2",5),t._uU(7," FSR Activity Report "),t.qZA()(),t._UZ(8,"div",6)(9,"div",6),t.TgZ(10,"div",3)(11,"input",7),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.startdate=n)})("input",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.changedate())}),t.qZA()(),t.TgZ(12,"div",3)(13,"input",8),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.enddate=n)}),t.ALo(14,"date"),t.qZA()(),t.TgZ(15,"div",6)(16,"button",9),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.LoadList())}),t._uU(17,"GO"),t.qZA()(),t.TgZ(18,"div",10)(19,"div",11)(20,"button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.convertToPDF())}),t.O4$(),t.TgZ(21,"svg",13),t._UZ(22,"path",14)(23,"path",15)(24,"path",16)(25,"path",17)(26,"path",18)(27,"path",19)(28,"path",20),t.qZA()(),t.kcU(),t.TgZ(29,"button",21),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.exportexcel())}),t.O4$(),t.TgZ(30,"svg",22),t._UZ(31,"path",14)(32,"path",15)(33,"path",16)(34,"path",23)(35,"path",24)(36,"path",25)(37,"path",26),t.qZA()()()()()()(),t.kcU(),t.TgZ(38,"div",27)(39,"div",1)(40,"div",28)(41,"div",29)(42,"div",30)(43,"div",31)(44,"div",32)(45,"div",33)(46,"div",34)(47,"div",35)(48,"select",36),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.condition=n)})("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.LoadList())}),t.TgZ(49,"option",37),t._uU(50,"Day wise Report"),t.qZA(),t.TgZ(51,"option",38),t._uU(52,"Time wise Report"),t.qZA()()(),t.TgZ(53,"div",39)(54,"div",40)(55,"input",41),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.searchvalue=n)})("keydown.enter",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.LoadList())}),t.qZA(),t.TgZ(56,"span",42),t.O4$(),t.TgZ(57,"svg",43),t._UZ(58,"path",14)(59,"path",44)(60,"path",45),t.qZA()()()()()(),t.kcU(),t.TgZ(61,"div",46),t.YNc(62,M,26,0,"div",47)(63,P,45,7,"table",48),t.qZA(),t.TgZ(64,"div",49)(65,"p",50),t._uU(66,"Showing "),t.TgZ(67,"span"),t._uU(68),t.qZA(),t._uU(69," to "),t.TgZ(70,"span"),t._uU(71),t.qZA(),t._uU(72," of "),t.TgZ(73,"span"),t._uU(74),t.qZA(),t._uU(75," entries "),t.qZA()()()()()()()()()}if(2&i){const e=t.oxw();t.xp6(11),t.Q6J("ngModel",e.startdate),t.xp6(2),t.Q6J("ngModel",e.enddate)("max",t.xi3(14,10,e.myDate,"yyyy-MM-dd")),t.xp6(35),t.Q6J("ngModel",e.condition),t.xp6(7),t.Q6J("ngModel",e.searchvalue),t.xp6(7),t.Q6J("ngIf",e.loader),t.xp6(1),t.Q6J("ngIf",!e.loader),t.xp6(5),t.Oqu(e.frompage),t.xp6(3),t.Oqu(e.topage),t.xp6(3),t.Oqu(e.total)}}function N(i,a){1&i&&t._uU(0," Loading... ")}function I(i,a){1&i&&t._uU(0," Loading... ")}function R(i,a){1&i&&(t.TgZ(0,"p"),t._uU(1,"Failed to load the Activity"),t.qZA())}function F(i,a){if(1&i){const e=t.EpF();t._uU(0,"FSR Activity Reports "),t.TgZ(1,"div",10)(2,"div",11)(3,"button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.convertvisitToPDF())}),t.O4$(),t.TgZ(4,"svg",13),t._UZ(5,"path",14)(6,"path",15)(7,"path",16)(8,"path",17)(9,"path",18)(10,"path",19)(11,"path",20),t.qZA()(),t.kcU(),t.TgZ(12,"button",21),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.exportvisitexcel())}),t.O4$(),t.TgZ(13,"svg",22),t._UZ(14,"path",14)(15,"path",15)(16,"path",16)(17,"path",23)(18,"path",24)(19,"path",25)(20,"path",26),t.qZA()()()()}}function S(i,a){1&i&&(t.TgZ(0,"div",51)(1,"ul",52)(2,"li",53)(3,"div",54),t._UZ(4,"p-skeleton",55),t.TgZ(5,"div",56),t._UZ(6,"p-skeleton",57)(7,"p-skeleton",58),t.qZA()()(),t.TgZ(8,"li",53)(9,"div",54),t._UZ(10,"p-skeleton",55),t.TgZ(11,"div",56),t._UZ(12,"p-skeleton",57)(13,"p-skeleton",58),t.qZA()()(),t.TgZ(14,"li",53)(15,"div",54),t._UZ(16,"p-skeleton",55),t.TgZ(17,"div",56),t._UZ(18,"p-skeleton",57)(19,"p-skeleton",58),t.qZA()()(),t.TgZ(20,"li")(21,"div",54),t._UZ(22,"p-skeleton",55),t.TgZ(23,"div",56),t._UZ(24,"p-skeleton",57)(25,"p-skeleton",58),t.qZA()()()()())}function J(i,a){if(1&i&&(t._UZ(0,"i",63),t._uU(1)),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("",e.retail.toLocaleString("en-IN")," ")}}function K(i,a){if(1&i&&(t._UZ(0,"i",63),t._uU(1)),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("",e.distributor1.toLocaleString("en-IN")," ")}}function G(i,a){if(1&i&&(t._UZ(0,"i",63),t._uU(1)),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("",e.distributor2.toLocaleString("en-IN")," ")}}function Y(i,a){if(1&i&&(t._UZ(0,"i",63),t._uU(1)),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij("",(e.distributor1+e.distributor2).toLocaleString("en-IN")," ")}}function j(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",86)(1,"td",66),t._uU(2),t.qZA(),t.TgZ(3,"td",87)(4,"div"),t._uU(5),t.qZA(),t.TgZ(6,"div"),t._uU(7),t.qZA()(),t.TgZ(8,"td",88)(9,"div",89),t._uU(10),t.TgZ(11,"span",35),t._uU(12),t.ALo(13,"date"),t.qZA()(),t.TgZ(14,"div",60),t._uU(15),t.ALo(16,"date"),t.ALo(17,"date"),t.qZA()(),t.TgZ(18,"td",60)(19,"div"),t._uU(20),t.qZA(),t.TgZ(21,"div"),t._uU(22),t.qZA()(),t.TgZ(23,"td",87)(24,"button",69),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw(4);return t.KtG(l.ActivityOrderbyid(r.Fk_Orderno))}),t._uU(25),t.qZA()(),t.TgZ(26,"td",87),t.YNc(27,J,2,1),t.qZA(),t.TgZ(28,"td",87),t.YNc(29,K,2,1),t.qZA(),t.TgZ(30,"td",90),t.YNc(31,G,2,1),t.qZA(),t.TgZ(32,"td",87),t.YNc(33,Y,2,1),t.qZA()()}if(2&i){const e=a.$implicit,o=a.$index;t.xp6(2),t.hij(" ",o+1," "),t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Oqu(e.ActionDescription),t.xp6(3),t.hij("",e.employee," "),t.xp6(2),t.hij("(",t.xi3(13,14,e.createdon,"dd/MM/yy hh:mm a"),")"),t.xp6(3),t.AsE("From ",t.xi3(16,17,e.FromTime,"dd/MM/yy hh:mm a")," To ",t.xi3(17,20,e.totime,"dd/MM/yy hh:mm a"),""),t.xp6(5),t.Oqu(e.Company),t.xp6(2),t.Oqu(e.GpsLocation),t.xp6(3),t.Oqu(e.Fk_Orderno),t.xp6(2),t.um2(27,e.retail>0?27:-1),t.xp6(2),t.um2(29,e.distributor1>0?29:-1),t.xp6(2),t.um2(31,e.distributor2>0?31:-1),t.xp6(2),t.um2(33,e.distributor1+e.distributor2>0?33:-1)}}function $(i,a){if(1&i&&(t.TgZ(0,"table",85)(1,"thead")(2,"tr")(3,"th",60),t._uU(4,"S.No"),t.qZA(),t.TgZ(5,"th",60),t._uU(6,"Type"),t.qZA(),t.TgZ(7,"th",60),t._uU(8,"Activity Time"),t.qZA(),t.TgZ(9,"th",60),t._uU(10,"Company/GPS Location"),t.qZA(),t.TgZ(11,"th",60),t._uU(12,"Order No."),t.qZA(),t.TgZ(13,"th",60),t._uU(14,"Retail Order"),t.qZA(),t.TgZ(15,"th",60),t._uU(16,"PreOrder"),t.qZA(),t.TgZ(17,"th",60),t._uU(18,"Order"),t.qZA(),t.TgZ(19,"th",60),t._uU(20,"Distributor Order"),t.qZA()()(),t.TgZ(21,"tbody"),t.SjG(22,j,34,23,"tr",91,t.x6l),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(22),t.wJu(e.activitylistreport)}}function B(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",29)(1,"div",32)(2,"div",33)(3,"div",34)(4,"div",35)(5,"h2",75),t._uU(6,"Activity Reports "),t.qZA()(),t.TgZ(7,"div",76)(8,"div",77)(9,"div",78),t._uU(10," Retail : "),t._UZ(11,"i",63),t._uU(12),t.qZA(),t.TgZ(13,"div",79),t._uU(14," Order : "),t._UZ(15,"i",63),t._uU(16),t.qZA(),t.TgZ(17,"div",80),t._uU(18," Order : "),t._UZ(19,"i",63),t._uU(20),t.qZA(),t.TgZ(21,"div",79),t._uU(22," Total Distributor : "),t._UZ(23,"i",63),t._uU(24),t.qZA()()(),t.TgZ(25,"div",39)(26,"div",40)(27,"input",81),t.NdJ("ngModelChange",function(n){t.CHM(e);const r=t.oxw(2);return t.KtG(r.customsearch=n)}),t.qZA(),t.TgZ(28,"span",42),t.O4$(),t.TgZ(29,"svg",43),t._UZ(30,"path",14)(31,"path",44)(32,"path",45),t.qZA()()()()()(),t.kcU(),t.TgZ(33,"div",82),t.YNc(34,S,26,0,"div",83)(35,$,24,0,"table",84),t.qZA()()()}if(2&i){const e=t.oxw(2);t.xp6(12),t.hij("",e.totalretail1.toLocaleString("en-IN")," "),t.xp6(4),t.hij("",e.totaldistributor1.toLocaleString("en-IN")," "),t.xp6(4),t.hij("",e.totaldistributor2.toLocaleString("en-IN")," "),t.xp6(4),t.hij("",(e.totaldistributor1+e.totaldistributor2).toLocaleString("en-IN")," "),t.xp6(3),t.Q6J("ngModel",e.customsearch),t.xp6(7),t.um2(34,e.activityloader?34:-1),t.xp6(1),t.um2(35,e.activityloader?-1:35)}}function W(i,a){if(1&i&&(t.TgZ(0,"div",49)(1,"p",50),t._uU(2,"Showing "),t.TgZ(3,"span"),t._uU(4,"1"),t.qZA(),t._uU(5," to "),t.TgZ(6,"span"),t._uU(7),t.qZA(),t._uU(8," of "),t.TgZ(9,"span"),t._uU(10),t.qZA(),t._uU(11," entries "),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(7),t.Oqu(e.activitylistreport.length),t.xp6(3),t.Oqu(e.activitylistreport.length)}}function H(i,a){if(1&i&&t.YNc(0,W,12,2,"div",92),2&i){const e=t.oxw(2);t.um2(0,e.activitylistreport?0:-1)}}function Q(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-sidebar",71),t.NdJ("visibleChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.activityvisible=n)}),t.YNc(1,F,21,0,"ng-template",72)(2,B,36,7,"ng-template",73)(3,H,1,1,"ng-template",74),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("visible",e.activityvisible)("fullScreen",!0)}}function z(i,a){if(1&i&&(t.TgZ(0,"h2"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" Order Details (",e.orderno,")")}}function V(i,a){if(1&i&&(t.TgZ(0,"tr",65)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"currency"),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.ALo(16,"currency"),t.qZA()()),2&i){const e=a.$implicit,o=a.$index;t.xp6(2),t.Oqu(o+1),t.xp6(2),t.Oqu(e.type),t.xp6(2),t.Oqu(e.itemname),t.xp6(2),t.Oqu(e.item_qty),t.xp6(2),t.Oqu(e.item_rate),t.xp6(2),t.Oqu(t.xi3(13,7,e.item_amt,"INR")),t.xp6(3),t.Oqu(t.xi3(16,10,e.item_qty*e.item_rate,"INR"))}}function X(i,a){if(1&i&&(t.TgZ(0,"table",94)(1,"thead")(2,"tr",60)(3,"th"),t._uU(4,"S.No."),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Type"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Item"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Quantity"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Rate"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Total(CRM)"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Total"),t.qZA()()(),t.TgZ(17,"tbody"),t.SjG(18,V,17,13,"tr",95,t.x6l),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(18),t.wJu(e.orderdata)}}const tt=()=>({width:"75vw"}),et=()=>({height:"500px"});function it(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-dialog",93),t.NdJ("visibleChange",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.displayordervisible=n)}),t.YNc(1,z,2,1,"ng-template",72)(2,X,20,0,"ng-template",73),t.qZA()}if(2&i){const e=t.oxw();t.Akn(t.DdM(7,tt)),t.Q6J("visible",e.displayordervisible)("resizable",!1)("modal",!0)("maximizable",!0)("contentStyle",t.DdM(8,et))}}let ot=(()=>{class i{constructor(e,o,n,r,l){this.service=e,this.toast=o,this.datePipe=n,this.route=r,this.userservice=l,this.loader=!1,this.p=1,this.psize=10,this.total=0,this.frompage=1,this.topage=10,this.searchvalue="",this.myDate=new Date,this.date1=new Date,this.date2=new Date,this.condition="Day",this.startdate=this.datePipe.transform(this.date1,"yyyy-MM-dd"),this.enddate=this.datePipe.transform(this.date2,"yyyy-MM-dd"),this.customsearch="",this.totalvisit=0,this.totalorders=0,this.totalretail=0,this.totaldistributor=0,this.totaldistributor0=0,this.totalretail1=0,this.totaldistributor1=0,this.totaldistributor2=0,this.visitexcelname="",this.activityloader=!1}ngOnInit(){this.LoadList()}LoadList(){this.loader=!0;let e=new Date(this.enddate),o=this.datePipe.transform(e.setDate(e.getDate()+1),"yyyy-MM-dd");this.service.GetCRMActivityReport(this.startdate,o,this.searchvalue,this.condition).subscribe(n=>{"success"==n.status?(this.loader=!1,this.list=n.data,this.total=n.data.length,this.frompage=1,this.topage=this.total,this.calculatetotal()):this.toast.error(n.message,"Warning")})}changedate(){this.enddate=this.startdate}calculatetotal(){this.totalvisit=0,this.totalorders=0,this.totalretail=0,this.totaldistributor=0,this.totaldistributor0=0,this.list.forEach(o=>{o.visit>0&&(this.totalvisit=this.totalvisit+parseFloat(o.visit)),o.totalorders>0&&(this.totalorders=this.totalorders+parseFloat(o.totalorders)),o.retail>0&&(this.totalretail=this.totalretail+parseFloat(o.retail)),o.distributor1>0&&(this.totaldistributor0=this.totaldistributor0+parseFloat(o.distributor1)),o.distributor2>0&&(this.totaldistributor=this.totaldistributor+parseFloat(o.distributor2))})}calculatetotal1(){this.totalretail1=0,this.totaldistributor1=0,this.totaldistributor2=0,this.activitylistreport.forEach(o=>{o.retail>0&&(this.totalretail1=this.totalretail1+parseFloat(o.retail)),o.distributor1>0&&(this.totaldistributor1=this.totaldistributor1+parseFloat(o.distributor1)),o.distributor2>0&&(this.totaldistributor2=this.totaldistributor2+parseFloat(o.distributor2))})}convertToPDF(){m()(document.getElementById("excel-table")).then(e=>{const o=e.toDataURL("image/png");let n=new g.ZP("p","mm","a4");var r=n.internal.pageSize.getWidth();n.addImage(o,"PNG",0,0,r,e.height*r/e.width);var nt=this.datePipe.transform(this.startdate,"dd-MMM-yyyy")+" - "+this.datePipe.transform(this.enddate,"dd-MMM-yyyy")+".pdf";n.save(nt)})}exportexcel(){let e=document.getElementById("excel-table");const o=c.P6.table_to_sheet(e),n=c.P6.book_new();c.P6.book_append_sheet(n,o,"Sheet1");var r=this.datePipe.transform(this.startdate,"dd-MMM-yyyy")+" - "+this.datePipe.transform(this.enddate,"dd-MMM-yyyy")+".xlsx";c.NC(n,r)}exportvisitexcel(){let e=document.getElementById("excel-visit");const o=c.P6.table_to_sheet(e),n=c.P6.book_new();c.P6.book_append_sheet(n,o,"Sheet1"),c.NC(n,this.visitexcelname+".xlsx")}convertvisitToPDF(){m()(document.getElementById("excel-visit")).then(e=>{const o=e.toDataURL("image/png");let n=new g.ZP("p","mm","a4");var r=n.internal.pageSize.getWidth();n.addImage(o,"PNG",0,0,r,e.height*r/e.width),n.save(this.visitexcelname+".pdf")})}LoadActivity(e){this.activityloader=!0,this.activityvisible=!0;let o=new Date(e.start_time);this.visitexcelname=e.name+" ("+this.datePipe.transform(o,"dd-MMM-yyyy")+")",this.datePipe.transform(o.setDate(o.getDate()+1),"yyyy-MM-dd"),this.service.GetCRMActivitydaywise(e.start_time,e.end_time,e.createdby).subscribe(r=>{"success"==r.status?(this.activityloader=!1,console.log(r),this.activitylistreport=r.data,this.calculatetotal1(),setTimeout(()=>{this.calculatetotal1()},1e3)):this.toast.error(r.message,"Warning")})}ActivityOrderbyid(e){this.orderdata=null,this.displayordervisible=!0,this.orderno=e,this.service.GetCRMOrderbyid(e).subscribe(o=>{"success"==o.status?(console.log(o),this.orderdata=o.data):this.toast.warning(o.message,"Warning")})}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(f.w),t.Y36(T._W),t.Y36(d.uU),t.Y36(y.F0),t.Y36(C.K))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-crmactivity"]],standalone:!0,features:[t.jDz],decls:12,vars:2,consts:[[1,"page-header","d-print-none"],[1,"container-xl"],[1,"row","g-2","align-items-center"],[1,"col-md-2"],[1,"page-pretitle"],[1,"page-title"],[1,"col-md-1"],["type","date",1,"form-control",3,"ngModel","ngModelChange","input"],["type","date",1,"form-control",3,"ngModel","max","ngModelChange"],["type","button",1,"btn","btn-info","btn-icon",3,"click"],[1,"col-auto","ms-auto","d-print-none"],[1,"btn-list"],["type","button",1,"btn","btn-danger","btn-icon",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor","fill","none","stroke-linecap","round","stroke-linejoin","round",1,"icon","icon-tabler","icon-tabler-file-type-pdf"],["stroke","none","d","M0 0h24v24H0z","fill","none"],["d","M14 3v4a1 1 0 0 0 1 1h4"],["d","M5 12v-7a2 2 0 0 1 2 -2h7l5 5v4"],["d","M5 18h1.5a1.5 1.5 0 0 0 0 -3h-1.5v6"],["d","M17 18h2"],["d","M20 15h-3v6"],["d","M11 15v6h1a2 2 0 0 0 2 -2v-2a2 2 0 0 0 -2 -2h-1z"],["type","button",1,"btn","btn-success","btn-icon",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor","fill","none","stroke-linecap","round","stroke-linejoin","round",1,"icon","icon-tabler","icon-tabler-file-type-xls"],["d","M4 15l4 6"],["d","M4 21l4 -6"],["d","M17 20.25c0 .414 .336 .75 .75 .75h1.25a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-1a1 1 0 0 1 -1 -1v-1a1 1 0 0 1 1 -1h1.25a.75 .75 0 0 1 .75 .75"],["d","M11 15v6h3"],[1,"page-body"],[1,"row","row-deck","row-cards"],[1,"col-12"],[1,"row","row-cards"],[1,"col-md-12","col-lg-12"],[1,"card"],[1,"card-body","border-bottom","py-3"],[1,"d-flex"],[1,"text-muted"],[1,"form-select",3,"ngModel","ngModelChange","change"],["value","Day"],["value","Time"],[1,"ms-auto","text-muted"],[1,"input-icon"],["type","text","placeholder","Search.....",1,"form-control",3,"ngModel","ngModelChange","keydown.enter"],[1,"input-icon-addon"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor","fill","none","stroke-linecap","round","stroke-linejoin","round",1,"icon"],["d","M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"],["d","M21 21l-6 -6"],[1,"table-responsive",2,"height","27rem"],["class","border-round border-1 surface-border p-4 surface-card",4,"ngIf"],["id","excel-table","class","table card-table table-vcenter datatable table-sm table-fixed",4,"ngIf"],[1,"card-footer","d-flex","align-items-center"],[1,"m-0","text-muted"],[1,"border-round","border-1","surface-border","p-4","surface-card"],[1,"m-0","p-0","list-none"],[1,"mb-3"],[1,"flex"],["shape","circle","size","4rem","styleClass","mr-2"],[2,"flex","1"],["width","100%","styleClass","mb-2"],["width","75%"],["id","excel-table",1,"table","card-table","table-vcenter","datatable","table-sm","table-fixed"],[1,"text-center"],["class","strong text-center",4,"ngFor","ngForOf"],[1,"text-center","strong"],[1,"fa","fa-rupee"],[1,"text-success"],[1,"strong","text-center"],[1,"w-1"],[1,"text-nowrap"],[4,"ngIf"],["type","button",1,"btn-link","strong",3,"click"],["class","text-success",4,"ngIf"],[3,"visible","fullScreen","visibleChange"],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"card-title"],[1,"ms-auto","strong"],[1,"row"],[1,"col-3","text-nowrap"],[1,"col-3","text-nowrap","text-danger"],[1,"col-3","text-nowrap","text-success"],["type","text","placeholder","Search.....",1,"form-control",3,"ngModel","ngModelChange"],[1,"table-responsive"],["class","border-round border-1 surface-border p-4 surface-card"],["id","excel-visit","class","table table-head-fixed table-sm table-fixed cell-border"],["id","excel-visit",1,"table","table-head-fixed","table-sm","table-fixed","cell-border"],[1,"strong"],[1,"text-nowrap","text-center"],[1,"text-nowrap","strong"],[1,"text-center","text-center"],[1,"text-nowrap","text-center","text-success"],["class","strong"],["class","card-footer d-flex align-items-center"],["appendTo","body",3,"visible","resizable","modal","maximizable","contentStyle","visibleChange"],[1,"table","table-head-fixed","table-sm","table-fixed","cell-border"],["class","strong text-center"]],template:function(o,n){1&o&&(t.YNc(0,k,76,13)(1,N,1,0)(2,I,1,0)(3,R,2,0),t.EqZ(4,0,b,1,2,3),t.FN0(),t.YNc(6,Q,4,2),t.EqZ(7,6,U),t.YNc(9,it,3,9),t.EqZ(10,9,A)),2&o&&(t.xp6(7),t.cPc(1==n.activityvisible),t.xp6(3),t.cPc(1==n.displayordervisible))},dependencies:[d.ez,s.u5,Z.l,h.S,p.m],styles:["table[_ngcontent-%COMP%], th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid black;border-collapse:collapse}tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{position:sticky;background:whitesmoke}tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{bottom:0}"]})}return i})()}}]);