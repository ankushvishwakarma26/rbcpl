"use strict";(self.webpackChunkintranet=self.webpackChunkintranet||[]).push([[5210],{5210:(B,m,a)=>{a.r(m),a.d(m,{MovementoverdueComponent:()=>G});var p=a(6814),l=a(6223),u=a(6521),_=a(7248),v=a(9246),g=a(951),f=a(2681),b=a(9176),h=a(1312),e=a(9212),x=a(377),M=a(2425),Z=a(5633),T=a(7473),A=a(1148),C=a(5219);function U(n,o){if(1&n){const t=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"div",34)(1,"div",35)(2,"button",43),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.AutoSubmit())}),e._uU(3,"Move to Account (Auto Sync)"),e.qZA()()()}}function E(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"h2",33),e._uU(1,"Movement Overdue List"),e.qZA(),e.TgZ(2,"div",34)(3,"div",35)(4,"input",36),e.NdJ("ngModelChange",function(s){e.CHM(t);const r=e.oxw();return e.KtG(r.searchvalue=s)}),e.qZA(),e.TgZ(5,"span",37),e.O4$(),e.TgZ(6,"svg",38),e._UZ(7,"path",39)(8,"path",40)(9,"path",41),e.qZA()()()(),e.YNc(10,U,4,0,"div",42)}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.searchvalue),e.xp6(6),e.Q6J("ngIf",t.isadmin)}}function O(n,o){if(1&n&&(e.TgZ(0,"span",50),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("ngClass","F2"==t.buyeraddress?"text-purple":"F3"==t.buyeraddress?"text-yellow":"F4"==t.buyeraddress?"text-orange":""),e.xp6(1),e.hij("(",t.buyeraddress,")")}}function y(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.AsE("",t.quantity,"(",e.xi3(2,2,t.rate,"INR"),")")}}function q(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"currency"),e.qZA(),e.TgZ(3,"div"),e._uU(4),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.AsE("",t.quantity,"(",e.xi3(2,4,t.rate,"INR"),")"),e.xp6(3),e.AsE("",t.size," (",t.repeat,")")}}function D(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr",17)(1,"td",49),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.TgZ(5,"span",50),e._uU(6),e.qZA(),e.YNc(7,O,2,2,"span",50),e.qZA(),e.TgZ(8,"td")(9,"div")(10,"button",51),e.NdJ("click",function(){const r=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.opendetails(r.uid))}),e._uU(11),e.qZA()(),e.TgZ(12,"div",52),e._uU(13),e.qZA()(),e.TgZ(14,"td"),e.YNc(15,y,3,5,"div")(16,q,5,7),e.qZA(),e.TgZ(17,"td")(18,"div"),e._uU(19),e.qZA(),e.TgZ(20,"div"),e._uU(21),e.ALo(22,"date"),e.qZA()(),e.TgZ(23,"td")(24,"button",53),e.NdJ("click",function(){const r=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.expendaccordion(r))}),e._uU(25,"Action"),e.qZA()()()}if(2&n){const t=o.$implicit,i=o.index;e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.uid),e.xp6(1),e.Q6J("ngClass","P2P"==t.type?"text-muted":"text-danger"),e.xp6(1),e.hij("(",t.type,")"),e.xp6(1),e.um2(7,"P2P"==t.type?7:-1),e.xp6(4),e.Oqu(t.name),e.xp6(2),e.Oqu(t.itemname),e.xp6(2),e.um2(15,"P2P"==t.type?15:16),e.xp6(4),e.Oqu(t.mrnby),e.xp6(2),e.Oqu(e.xi3(22,10,t.mrndate,"dd-MMM-yyyy hh:mm a"))}}function P(n,o){if(1&n&&(e.TgZ(0,"div",7)(1,"div",10)(2,"div",44)(3,"div",45)(4,"table",46)(5,"thead")(6,"tr")(7,"th",47),e._uU(8,"S.No."),e.qZA(),e.TgZ(9,"th",47),e._uU(10,"UID"),e.qZA(),e.TgZ(11,"th",47),e._uU(12,"Vender Name/Item Name"),e.qZA(),e.TgZ(13,"th",47),e._uU(14,"Rate/Qty"),e.qZA(),e.TgZ(15,"th",47),e._uU(16,"Last Update"),e.qZA(),e.TgZ(17,"th",47),e._uU(18,"Action"),e.qZA()()(),e.TgZ(19,"tbody"),e.YNc(20,D,26,13,"tr",48),e.ALo(21,"filter"),e.qZA()()()()()()),2&n){const t=e.oxw();e.xp6(20),e.Q6J("ngForOf",e.xi3(21,1,t.service.p2plistoverduelist,t.searchvalue))}}function I(n,o){if(1&n&&(e.TgZ(0,"div",54)(1,"p",55),e._uU(2,"Showing "),e.TgZ(3,"span"),e._uU(4,"1"),e.qZA(),e._uU(5," to "),e.TgZ(6,"span"),e._uU(7),e.qZA(),e._uU(8," of "),e.TgZ(9,"span"),e._uU(10),e.qZA(),e._uU(11," entries"),e.qZA()()),2&n){const t=e.oxw();e.xp6(7),e.Oqu(t.service.p2plistoverduelist.length),e.xp6(3),e.Oqu(t.service.p2plistoverduelist.length)}}function w(n,o){1&n&&(e.TgZ(0,"div",58),e._uU(1,"Drag and drop files"),e.qZA())}function F(n,o){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.AsE("",t.name," - ",t.size," bytes ")}}function L(n,o){if(1&n&&(e.TgZ(0,"ul"),e.YNc(1,F,2,2,"li",59),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.uploadedFiles)}}function J(n,o){if(1&n&&e.YNc(0,L,2,1,"ul",31),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.uploadedFiles.length)}}function N(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",21)(1,"p-fileUpload",56),e.NdJ("onUpload",function(s){e.CHM(t);const r=e.oxw();return e.KtG(r.onUpload(s))}),e.YNc(2,w,2,0,"ng-template",57)(3,J,1,1,"ng-template",2),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("url",t.imageservice.uploadurl+"/"+t.service.p2pitemdata.uid+"/Movement")("multiple",!0)}}function S(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",60),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.MovetoMovement())}),e._uU(1,"Move to Movement (Admin)"),e.qZA()}}function Q(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",69),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,r=e.oxw();return e.KtG(r.DeleteImage(s.id))}),e.O4$(),e.TgZ(1,"svg",38),e._UZ(2,"path",39)(3,"path",70)(4,"path",71),e.qZA()()}}function R(n,o){if(1&n&&e._UZ(0,"p-image",72),2&n){const t=e.oxw().$implicit,i=e.oxw();e.Q6J("src",i.imageservice.imageurl+t.path)("preview",!0)}}function K(n,o){if(1&n&&(e.TgZ(0,"a",73),e._UZ(1,"img",74),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw();e.Q6J("href",i.imageservice.imageurl+t.path,e.LSH)}}function Y(n,o){if(1&n&&(e.TgZ(0,"div",61)(1,"div",44)(2,"div",62)(3,"h3",63),e._uU(4),e.qZA(),e.TgZ(5,"div",64),e.YNc(6,Q,5,0,"button",65),e.qZA()(),e.TgZ(7,"div",66),e.YNc(8,R,1,2,"p-image",67)(9,K,2,1,"a",68),e.qZA()()()),2&n){const t=o.$implicit,i=e.oxw();e.xp6(4),e.Oqu(t.type),e.xp6(2),e.Q6J("ngIf",i.isadmin),e.xp6(2),e.Q6J("ngIf","pdf"!=t.path.split(".").pop()),e.xp6(1),e.Q6J("ngIf","pdf"==t.path.split(".").pop())}}function W(n,o){1&n&&(e.TgZ(0,"div")(1,"h1",75),e._uU(2,"No File Uploaded"),e.qZA()())}const k=()=>({width:"100vw"});let G=(()=>{class n{constructor(t,i,s,r,d){this.service=t,this.toast=i,this.userservice=s,this.imageservice=r,this.tenderservice=d,this.isadmin=!1,this.searchvalue="",this.panelOpenState=!1,this.visible=!1,this.uploadedFiles=[],this.autosubmitcount=0}ngOnInit(){"Admin"==this.userservice.GetRole()&&(this.isadmin=!0)}opendetails(t){this.service.GetP2Pbyid(t).subscribe(i=>{this.service.p2pdata=i.data}),this.service.detail=!0,null!=this.service.p2pdata.accountdate?this.service.p2pdata.status=10:null!=this.service.p2pdata.movementdate?this.service.p2pdata.status=9:null!=this.service.p2pdata.mrndate?this.service.p2pdata.status=8:null!=this.service.p2pdata.mandate?this.service.p2pdata.status=7:null!=this.service.p2pdata.gerdate?this.service.p2pdata.status=6:null!=this.service.p2pdata.podate?this.service.p2pdata.status=5:null!=this.service.p2pdata.approvaldate||null!=this.service.p2pdata.quotationdate?this.service.p2pdata.status=4:null!=this.service.p2pdata.updateddate?this.service.p2pdata.status=2:null!=this.service.p2pdata.createddate&&(this.service.p2pdata.status=1),this.service.GetP2PItemListbyid(t).subscribe(i=>{console.log(i),"success"==i.status&&(this.service.p2pitemlist=i.data)}),this.service.GetP2PApprovedItemListbyid(t).subscribe(i=>{console.log(i),"success"==i.status&&(this.service.p2papproveditemlist=i.data)}),this.imageservice.GetDocumentsbyid(t).subscribe(i=>{"success"==i.status&&(this.imageservice.rcuploadedlist=i.data),console.log(i)})}LoadOverdueList(){this.service.P2PItemList("MovementOverdue").subscribe(t=>{console.log(t),"success"==t.status&&(this.service.p2plistoverduelist=t.data)},t=>{this.toast.error(t)})}LoadDashboard(){this.service.GetDashboardReport().subscribe(t=>{this.service.dashboarddata=t})}gettime(){let t=new Date,s=t.getTime()+Math.abs(6e4*t.getTimezoneOffset());return new Date(s).toISOString()}expendaccordion(t){this.service.p2pitemdata=new g.bY,this.service.p2pitemdata=t,this.imageservice.id=t.uid,this.imageservice.RefreshFile(),this.visible=!0,this.tenderservice.tenderchatid=t.uid,this.tenderservice.Chatbyid(t.uid),this.tenderservice.ReadChat(t.uid,this.userservice.GetUserName(),this.userservice.GetFullName()),this.tenderservice.tenderchatdata=new g.Y_,this.tenderservice.tenderchatdata.header="Movement Overdue",this.tenderservice.tenderchatdata.type="P2P"}onUpload(t){for(let i of t.files)this.uploadedFiles.push(i);this.service.p2pitemdata.movementimage="Yes",this.imageservice.id=this.service.p2pitemdata.uid,this.service.CreateUpdateQuotation().subscribe(i=>{"success"==i.status?(this.toast.success("ADR Uploaded Successfully","Success"),this.imageservice.RefreshFile()):this.toast.warning(i.message,"Warning")},i=>{this.toast.error(i,"Error")})}DeleteImage(t){1==confirm("Are You Sure want to Delete?")?this.imageservice.DeleteImage(t).subscribe(i=>{console.log(i),(i.status="success")?this.toast.success(i.result,"Success"):this.toast.error(i.result,"Error"),this.imageservice.RefreshFile()}):this.toast.warning("File Deletion Cancelled","Cancelled")}AutoSubmit(){this.autosubmitcount=0,1==confirm("Are You Sure want to Move All Items to Account?")?(this.service.p2plistoverduelist.forEach(t=>{this.service.p2pitemdata=t,this.service.p2pitemdata&&(this.service.p2pitemdata.movementby="Auto Submit",this.service.p2pitemdata.movementdate=this.gettime(),this.service.CreateUpdateQuotation().subscribe(i=>{"success"==i.status?this.autosubmitcount++:this.toast.warning(i.message,"Warning")},i=>{this.toast.error(i,"Error")}))}),this.autosubmitcount>0?(this.toast.success(this.autosubmitcount+" Auto Submitted Successfully","Success"),this.LoadOverdueList(),this.LoadDashboard()):this.toast.warning("No Auto Submit Acceptation Found","Warning")):this.toast.warning("Auto Submit Cancelled","Warning")}updatemrn(t){t.valid?(this.service.p2pitemdata.movementdate=this.gettime(),this.service.p2pitemdata.movementby=this.userservice.GetFullName(),this.service.CreateUpdateQuotation().subscribe(i=>{"success"==i.status?(this.toast.success(i.message,"Success"),this.service.p2plistoverduelist=null,this.visible=!1,this.LoadDashboard(),this.LoadOverdueList()):this.toast.warning(i.message,"Warning")},i=>{this.toast.error(i,"Error")})):this.toast.warning("Please Update GER Number","Warning")}MovetoMovement(){this.service.p2pitemdata.movementdate=this.gettime(),this.service.p2pitemdata.movementby=this.userservice.GetFullName(),this.service.CreateUpdateQuotation().subscribe(t=>{"success"==t.status?(this.toast.success(t.message,"Success"),this.service.p2plistoverduelist=null,this.LoadDashboard(),this.LoadOverdueList()):this.toast.warning(t.message,"Warning")},t=>{this.toast.error(t,"Error")})}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(x.h),e.Y36(M._W),e.Y36(Z.K),e.Y36(T.D),e.Y36(A.$))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-movementoverdue"]],standalone:!0,features:[e.jDz],decls:48,vars:24,consts:[[3,"visible","fullScreen","visibleChange"],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],["header","Movement Overdue Form",3,"visible","maximizable","visibleChange"],[1,"row","g-0"],[1,"col-12","col-lg-9","col-xl-9","border-end"],[1,"row","row-cards"],[1,"col-md-6","strong","text-center"],[1,"form-label"],[1,"col-12"],["autocomplete","off",3,"ngSubmit"],["mygerForm","ngForm"],["type","hidden","name","Id",3,"value"],["type","hidden","name","uid",3,"value"],[1,"col-sm-12","col-md-12"],[1,"mb-3"],[1,"strong","text-center"],["type","hidden","required","","name","movementimage",3,"ngModel","ngModelChange"],["movementimage","ngModel"],[1,"row"],[1,"col-md-6"],[1,"form-label","required"],["required","","rows","5","name","movementremarks",1,"form-control",3,"ngClass","ngModel","ngModelChange"],["movementremarks","ngModel"],["class","col-md-6",4,"ngIf"],[1,"card-footer","text-end"],[1,"d-flex"],["type","submit",1,"btn","btn-primary","ms-auto",3,"disabled"],["type","button","class","btn btn-success ms-auto",3,"click",4,"ngIf"],["class","col-2",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-12","col-lg-3","col-xl-3","d-flex","flex-column"],[1,"page-title"],[1,"ms-auto","text-muted"],[1,"input-icon"],["type","text","placeholder","Search.....",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-icon-addon"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor","fill","none","stroke-linecap","round","stroke-linejoin","round",1,"icon"],["stroke","none","d","M0 0h24v24H0z","fill","none"],["d","M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"],["d","M21 21l-6 -6"],["class","ms-auto text-muted",4,"ngIf"],["type","button",1,"btn","btn-outline-warning","btn-pill",3,"click"],[1,"card"],[1,"table-responsive"],["id","contentToConvert",1,"table","card-table","table-vcenter","datatable","table-sm","table-fixed"],[1,"text-center"],["class","strong text-center",4,"ngFor","ngForOf"],[1,"text-nowrap"],[3,"ngClass"],["type","button",1,"btn-link","strong",3,"click"],[1,"text-danger"],["type","button",1,"btn","btn-outline-info","btn-pill","strong",3,"click"],[1,"card-footer","d-flex","align-items-center"],[1,"m-0","strong"],["name","demo[]",3,"url","multiple","onUpload"],["pTemplate","toolbar"],[1,"py-3"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-success","ms-auto",3,"click"],[1,"col-2"],[1,"card-header"],[1,"card-title"],[1,"card-actions","btn-actions"],["type","button","class","btn-action text-danger",3,"click",4,"ngIf"],[1,"card-body","p-0"],["width","250","height","250",3,"src","preview",4,"ngIf"],["class","text-center","target","_blank",3,"href",4,"ngIf"],["type","button",1,"btn-action","text-danger",3,"click"],["d","M18 6l-12 12"],["d","M6 6l12 12"],["width","250","height","250",3,"src","preview"],["target","_blank",1,"text-center",3,"href"],["src","https://upload.wikimedia.org/wikipedia/commons/8/87/PDF_file_icon.svg","width","250","height","250"],[1,"text-danger","text-center"]],template:function(i,s){if(1&i){const r=e.EpF();e.TgZ(0,"p-sidebar",0),e.NdJ("visibleChange",function(c){return s.service.movementoverduevisible=c}),e.YNc(1,E,11,2,"ng-template",1)(2,P,22,4,"ng-template",2)(3,I,12,2,"ng-template",3),e.qZA(),e.TgZ(4,"p-dialog",4),e.NdJ("visibleChange",function(c){return s.visible=c}),e.TgZ(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"label",9),e._uU(10),e.qZA(),e.TgZ(11,"label",9),e._uU(12),e.qZA()(),e.TgZ(13,"div",8)(14,"label",9),e._uU(15),e.qZA(),e.TgZ(16,"label",9),e._uU(17),e.ALo(18,"currency"),e.qZA()()(),e.TgZ(19,"div",10)(20,"form",11,12),e.NdJ("ngSubmit",function(){e.CHM(r);const c=e.MAs(21);return e.KtG(c.form.valid&&s.updatemrn(c))}),e.TgZ(22,"div",7),e._UZ(23,"input",13)(24,"input",14),e.TgZ(25,"div",15)(26,"div",16)(27,"h2",17),e._uU(28,"Upload Movement Image"),e.qZA(),e.TgZ(29,"input",18,19),e.NdJ("ngModelChange",function(c){return s.service.p2pitemdata.movementimage=c}),e.qZA(),e.TgZ(31,"div",20)(32,"div",21)(33,"label",22),e._uU(34,"Remakrs"),e.qZA(),e.TgZ(35,"textarea",23,24),e.NdJ("ngModelChange",function(c){return s.service.p2pitemdata.movementremarks=c}),e.qZA()(),e.YNc(37,N,4,2,"div",25),e.qZA()()(),e.TgZ(38,"div",26)(39,"div",27)(40,"button",28),e._uU(41,"Submit"),e.qZA(),e.YNc(42,S,2,0,"button",29),e.qZA()()()()(),e.TgZ(43,"div",20),e.YNc(44,Y,10,4,"div",30)(45,W,3,0,"div",31),e.qZA()(),e.TgZ(46,"div",32),e._UZ(47,"app-tenderchat"),e.qZA()()()}if(2&i){const r=e.MAs(21),d=e.MAs(36);e.Q6J("visible",s.service.movementoverduevisible)("fullScreen",!0),e.xp6(4),e.Akn(e.DdM(23,k)),e.Q6J("visible",s.visible)("maximizable",!0),e.xp6(6),e.hij("Vender : ",s.service.p2pitemdata.name,""),e.xp6(2),e.hij("Quantity : ",s.service.p2pitemdata.quantity,""),e.xp6(3),e.hij("Item Name : ",s.service.p2pitemdata.itemname,""),e.xp6(2),e.hij("Rate : ",e.xi3(18,20,s.service.p2pitemdata.rate,"INR"),""),e.xp6(6),e.Q6J("value",s.service.p2pitemdata.Id),e.xp6(1),e.Q6J("value",s.service.p2pitemdata.uid),e.xp6(5),e.Q6J("ngModel",s.service.p2pitemdata.movementimage),e.xp6(6),e.Q6J("ngClass",d.invalid?"is-invalid":"is-valid mb-2")("ngModel",s.service.p2pitemdata.movementremarks),e.xp6(2),e.Q6J("ngIf",s.service.p2pitemdata.movementremarks),e.xp6(3),e.Q6J("disabled",r.invalid),e.xp6(2),e.Q6J("ngIf",s.isadmin),e.xp6(2),e.Q6J("ngForOf",s.imageservice.rcuploadedlist),e.xp6(1),e.Q6J("ngIf",null==s.imageservice.rcuploadedlist)}},dependencies:[p.ez,p.mk,p.sg,p.O5,p.H9,p.uU,l.u5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.On,l.F,v.l,v.Y,C.jx,_.$,_.E,u.O,u.p,f.FilterPipe,b.TenderchatComponent,h.S,h.V]})}return n})()}}]);