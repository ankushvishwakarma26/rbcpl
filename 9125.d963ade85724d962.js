"use strict";(self.webpackChunkintranet=self.webpackChunkintranet||[]).push([[9125],{9125:(A,h,a)=>{a.r(h),a.d(h,{AuthlockComponent:()=>Z});var u=a(6814),n=a(6223),d=a(1312),g=a(1687),t=a(9212),p=a(5633),m=a(266),_=a(2425),b=a(8778),f=a(9862);function v(i,l){if(1&i&&(t.TgZ(0,"label",31),t._UZ(1,"i",32),t._uU(2),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.twofactorerror,"")}}function w(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"h3",23),t._uU(1),t.qZA(),t.TgZ(2,"h3",24)(3,"button",25),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.ResentOTP())}),t._uU(4),t.qZA()(),t.TgZ(5,"div",26)(6,"label",27),t._uU(7," One Time Password "),t.qZA(),t.TgZ(8,"div",28)(9,"input",29),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.otp=s)})("input",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.CheckTwoFactorAuthentication())}),t.qZA()(),t.YNc(10,v,3,1,"label",30),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.hij("Please confirm your account by entering the authorization code sent to +91 ***-***-",e.respdata.mobile.substring(6,10)," "),t.xp6(2),t.Q6J("disabled",0!=e.time),t.xp6(1),t.Oqu(0==e.time?"Resent OTP":e.time+" Seconds"),t.xp6(5),t.Q6J("ngModel",e.otp),t.xp6(1),t.um2(10,e.twofactorerror?10:-1)}}function T(i,l){1&i&&(t.TgZ(0,"div",50),t._UZ(1,"div",51),t.qZA())}function x(i,l){if(1&i&&(t.TgZ(0,"label",31),t._UZ(1,"i",32),t._uU(2),t.qZA()),2&i){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.errormessage,"")}}function C(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"form",33,34),t.NdJ("submit",function(){t.CHM(e);const s=t.MAs(1),r=t.oxw();return t.KtG(r.ProceedLogin(s))}),t.TgZ(2,"div",35)(3,"h2",36),t._uU(4,"Account Locked"),t.qZA(),t.TgZ(5,"p",37),t._uU(6,"Please enter your password to unlock your account"),t.qZA()(),t.TgZ(7,"div",35)(8,"span",38),t._uU(9),t.qZA(),t.TgZ(10,"h3"),t._uU(11),t.qZA()(),t.TgZ(12,"div",26)(13,"label",27),t._uU(14," Password "),t.TgZ(15,"span",39)(16,"a",40),t._uU(17,"I forgot password"),t.qZA()()(),t.TgZ(18,"div",28)(19,"input",41),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.service.logindata.password=s)})("keyup",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.loginbutton="Unlock")}),t.qZA(),t.TgZ(20,"span",42)(21,"a",43),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.showPassword())}),t._UZ(22,"i"),t.qZA()()()(),t.TgZ(23,"div",26)(24,"label",44)(25,"input",45),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.rememberme=s)}),t.qZA(),t.TgZ(26,"span",46),t._uU(27,"Remember me on this device"),t.qZA()()(),t.YNc(28,T,2,0,"div",47),t.TgZ(29,"div",48)(30,"button",49),t._uU(31),t.qZA()(),t._UZ(32,"br"),t.YNc(33,x,3,1,"label",30),t.qZA()}if(2&i){const e=t.MAs(1),o=t.oxw();t.xp6(9),t.Oqu(o.fullname.substring(0,1)),t.xp6(2),t.Oqu(o.fullname),t.xp6(8),t.Q6J("type",o.show_button?"text":"password")("ngModel",o.service.logindata.password),t.xp6(3),t.Tol(o.show_eye?"fa fa-eye":"fa fa-eye-slash"),t.xp6(3),t.Q6J("ngModel",o.rememberme),t.xp6(3),t.um2(28,o.loader?28:-1),t.xp6(2),t.Q6J("disabled",e.invalid),t.xp6(1),t.Oqu(o.loginbutton),t.xp6(2),t.um2(33,o.errormessage?33:-1)}}let Z=(()=>{class i{constructor(e,o,s,r,c){this.service=e,this.route=o,this.toast=s,this.waservice=r,this.http=c,this.logonurl="",this.warningpopup=!1,this.loginbutton="Unlock",this.fullname="",this.loader=!1,this.otpvisible=!1,this.errormessage=null,this.show_button=!1,this.show_eye=!1,this.rememberme=!1,this.emailpassword=!1,this.mobilewithotp=!1,this.lat=" ",this.lng=" ",this.time=300,this.twofactorerror=""}ngOnInit(){var e=window.location.pathname,o=window.location.href,c=window.location.href.substring(0,o.length-e.length);this.logonurl=c,this.getLocation(),this.service.IsLoogedIn()?this.CheckToken():(localStorage.clear(),this.route.navigate(["login"]))}CheckToken(){this.service.logindata.username=this.service.GetUserName(),this.fullname=this.service.GetFullName()}getLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{e&&(this.lat=e.coords.latitude,this.lng=e.coords.longitude)})}changelogin(){this.emailpassword=!this.emailpassword}showPassword(){this.show_button=!this.show_button,this.show_eye=!this.show_eye}getRandomNumber(){return Math.floor(899999*Math.random())+1e5}ProceedLogin(e){e.valid&&(this.loader=!0,this.loginbutton="Please wait.....",this.service.GetComputerName().subscribe(o=>{this.service.logindata.computer=o.computer}),this.service.logindata.computer=this.service.GetComputer(),this.service.logindata.logon=this.logonurl,this.service.logindata.longitude=this.lng.toString(),this.service.logindata.latitude=this.lat.toString(),this.service.ProceedLogin().subscribe(o=>{this.loader=!1,this.respdata=o,"success"==this.respdata.status?(this.loginbutton="Success",this.SuccessLogin()):"inactive"==this.respdata.status?(this.toast.warning(this.respdata.message,"Warning"),this.warningpopup=!0,this.errormessage=this.respdata.message,this.loginbutton="Failed to Login"):"leavesuccess"==this.respdata.status?this.ResentOTP():(this.warningpopup=!0,this.toast.error(this.respdata.message,"Error"),this.errormessage=this.respdata.message,this.loginbutton="Failed to Login")},o=>{401==o.status?(this.warningpopup=!0,this.toast.error("Either Username or Password are Incorrect","Error"),this.errormessage="Either Username or Password are Incorrect",this.loginbutton="Failed to Login"):(this.warningpopup=!0,this.toast.error(o,"Error"),this.errormessage=o,this.loginbutton="Failed to Login")}))}RemindResetOTP(){this.time=300,this.subscription=(0,g.F)(1e3).subscribe(e=>{this.time--,0==this.time&&(this.UnsubscribeOTPSubscription(),this.time=0)})}UnsubscribeOTPSubscription(){this.subscription&&this.subscription.unsubscribe()}ResentOTP(){this.storeotp=this.getRandomNumber();var e="Please use OTP "+this.storeotp+" to login to your INTRANET account. OTP valid for 10 minutes";localStorage.getItem("mobile"),this.waservice.sendotp(this.respdata.mobile,e).subscribe(s=>{"success"==s.status?(this.loader=!1,this.otpvisible=!0,this.toast.success("OTP Successfully Sent","Success"),this.RemindResetOTP()):(this.loader=!1,this.errormessage=s.message)},s=>{this.loader=!1,this.errormessage=s.message})}CheckTwoFactorAuthentication(){var o=this.otp.toString().length;6==o&&this.otp==this.storeotp?("leavesuccess"==this.respdata.status?this.SuccessLeaveLogin():this.SuccessLogin(),this.twofactorerror=""):6==o&&this.otp!=this.storeotp&&(this.toast.warning("Invalid OTP!!! Please Check Your OTP then Try again.","Warning"),this.twofactorerror="Invalid OTP!!! Please Check Your OTP then Try again.")}SuccessLogin(){localStorage.setItem("token",this.respdata.token),1==this.rememberme?localStorage.setItem("expiration",this.respdata.expiration):(this.date=new Date,this.date.setDate(this.date.getDate()+1),localStorage.setItem("expiration",this.date.toJSON())),localStorage.setItem("parth",this.respdata.parth),localStorage.setItem("profile",this.respdata.profile),localStorage.setItem("eid",this.respdata.eid),this.toast.success("Congratulation You have Successfully Logged in","Success"),setTimeout(()=>{window.open("./","_self")},500)}SuccessLeaveLogin(){this.date=new Date,this.date.setDate(this.date.getDate()+1),localStorage.setItem("expiration",this.date.toJSON()),localStorage.setItem("Role","LeaveOnly"),localStorage.setItem("name",this.respdata.name),localStorage.setItem("mobile",this.respdata.mobile),localStorage.setItem("eid",this.respdata.eid),this.toast.success("Congratulation You have Successfully Logged in","Success"),setTimeout(()=>{window.open("./","_self")},500)}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(p.K),t.Y36(m.F0),t.Y36(_._W),t.Y36(b.C),t.Y36(f.eN))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-authlock"]],standalone:!0,features:[t.jDz],decls:28,vars:1,consts:[[1,"d-flex","flex-column","bg-white"],[1,"row","g-0","flex-fill"],[1,"col-12","col-lg-6","col-xl-4","border-top-wide","border-primary","d-flex","flex-column","justify-content-center"],[1,"container","container-tight","my-5","px-lg-5"],[1,"text-center","mb-4"],["routerLink","",1,"navbar-brand","navbar-brand-autodark"],["src","http://6am12pm.com/wp-content/uploads/2019/03/intranet-logo.png","height","36","alt",""],[1,"col-12","col-lg-6","col-xl-8","d-none","d-lg-block"],["id","carousel-indicators","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-indicators"],["type","button","data-bs-target","#carousel-indicators","data-bs-slide-to","0",1,"active"],["type","button","data-bs-target","#carousel-indicators","data-bs-slide-to","1",1,""],["type","button","data-bs-target","#carousel-indicators","data-bs-slide-to","2",1,""],["type","button","data-bs-target","#carousel-indicators","data-bs-slide-to","3",1,""],["type","button","data-bs-target","#carousel-indicators","data-bs-slide-to","4",1,""],[1,"carousel-inner"],[1,"carousel-item","active"],["alt","","src","https://preview.tabler.io/static/photos/home-office-desk-with-macbook-iphone-calendar-watch-and-organizer.jpg",1,"bg-cover","h-100","min-vh-100"],[1,"carousel-item"],["alt","","src","https://preview.tabler.io/static/photos/workplace-with-laptop-on-table-at-home.jpg",1,"bg-cover","h-100","min-vh-100"],["alt","","src","https://preview.tabler.io/static/photos/white-apple-imac-computer-with-elephant-mousepad.jpg",1,"bg-cover","h-100","min-vh-100"],["alt","","src","https://preview.tabler.io/static/photos/workplace-with-laptop-on-table-at-home-2.jpg",1,"bg-cover","h-100","min-vh-100"],["alt","","src","https://preview.tabler.io/static/photos/working-in-a-restaurant-macbook-cheese-cake-and-cup-of-coffee.jpg",1,"bg-cover","h-100","min-vh-100"],[1,"text-success","text-center"],[1,"text-center"],["type","button",1,"btn","btn-info",3,"disabled","click"],[1,"mb-2"],[1,"form-label"],[1,"input-group","input-group-flat"],["type","number","pattern","[0-9]{6}","required","","placeholder","One Time Password","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange","input"],["class","form-label text-danger text-center"],[1,"form-label","text-danger","text-center"],[1,"fa","fa-warning"],[3,"submit"],["loginform","ngForm"],[1,"mb-4","text-center"],[1,"card-title"],[1,"text-secondary"],[1,"avatar","avatar-xl","mb-3"],[1,"form-label-description"],["href","./login"],["required","","name","password","placeholder","Your password","autocomplete","off",1,"form-control",3,"type","ngModel","ngModelChange","keyup"],[1,"input-group-text"],["title","Show password","data-bs-toggle","tooltip",1,"link-secondary",3,"click"],[1,"form-check"],["name","rememberme","type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],["class","progress"],[1,"form-footer"],["type","submit",1,"btn","btn-primary","w-100",3,"disabled"],[1,"progress"],[1,"progress-bar","progress-bar-indeterminate","bg-green"]],template:function(o,s){1&o&&(t.TgZ(0,"body",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"a",5),t._UZ(6,"img",6),t.qZA()(),t.YNc(7,w,11,5)(8,C,34,11),t.qZA()(),t.TgZ(9,"div",7)(10,"div",8)(11,"div",9),t._UZ(12,"button",10)(13,"button",11)(14,"button",12)(15,"button",13)(16,"button",14),t.qZA(),t.TgZ(17,"div",15)(18,"div",16),t._UZ(19,"img",17),t.qZA(),t.TgZ(20,"div",18),t._UZ(21,"img",19),t.qZA(),t.TgZ(22,"div",18),t._UZ(23,"img",20),t.qZA(),t.TgZ(24,"div",18),t._UZ(25,"img",21),t.qZA(),t.TgZ(26,"div",18),t._UZ(27,"img",22),t.qZA()()()()()()),2&o&&(t.xp6(7),t.um2(7,s.otpvisible?7:8))},dependencies:[u.ez,n.u5,n._Y,n.Fj,n.wV,n.Wl,n.JJ,n.JL,n.Q7,n.c5,n.On,n.F,d.S]})}return i})()}}]);