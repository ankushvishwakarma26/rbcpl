"use strict";(self.webpackChunkintranet=self.webpackChunkintranet||[]).push([[9176],{9176:(P,h,s)=>{s.r(h),s.d(h,{TenderchatComponent:()=>F});var _=s(6814),l=s(6223),p=s(9446),u=s(8454),m=s(3997),t=s(9212),g=s(1148),v=s(7473),x=s(2425),C=s(5633),T=s(5219);function b(n,r){1&n&&(t.TgZ(0,"h2",8),t._uU(1,"No Chat"),t.qZA())}function f(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",40),t.NdJ("click",function(i){t.CHM(e),t.oxw();const o=t.MAs(21),c=t.oxw().$implicit,d=t.oxw(2);return o.toggle(i),t.KtG(d.EditChat(c))}),t._UZ(1,"i",41),t.qZA()}}function M(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",42),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,o=t.oxw(2);return t.KtG(o.DeleteChat(i.id))}),t._UZ(1,"i",43),t.qZA()}}function Z(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"div",16)(3,"div",17)(4,"div",18)(5,"div",19)(6,"div",20)(7,"div",21),t._uU(8),t.qZA(),t._UZ(9,"div",22),t.qZA()(),t.TgZ(10,"div",23),t._UZ(11,"div",24),t.qZA(),t.TgZ(12,"div",19)(13,"div",20),t._UZ(14,"div",21),t.TgZ(15,"div",22),t._uU(16),t.ALo(17,"date"),t.YNc(18,f,2,0,"button",25)(19,M,2,0,"button",26),t.qZA()()(),t.TgZ(20,"p-overlayPanel",null,27)(22,"div",4)(23,"textarea",28),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw(3);return t.KtG(o.editmessage=i)})("keydown.control.enter",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.onEditCtrlEnter())})("keydown.enter",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.EditMessage())}),t.qZA(),t.TgZ(24,"span",6)(25,"button",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.EditMessage())}),t.O4$(),t.TgZ(26,"svg",30),t._UZ(27,"path",31)(28,"path",32)(29,"path",33),t.qZA()()()()()()()(),t.kcU(),t.TgZ(30,"div",34)(31,"button",35),t.NdJ("click",function(i){t.CHM(e);const o=t.oxw().$implicit,c=t.MAs(3),d=t.oxw(2);return c.toggle(i),t.KtG(d.service.ReadTenderChatbyid(o.id))}),t.O4$(),t.TgZ(32,"svg",36),t._UZ(33,"path",31)(34,"path",37)(35,"path",38)(36,"path",39),t.qZA()()()()()}if(2&n){const e=t.oxw().$implicit,a=t.oxw(2);t.xp6(8),t.AsE("",e.createdby," (",e.header,")"),t.xp6(3),t.Q6J("innerText",e.text),t.xp6(5),t.hij("",t.xi3(17,7,e.createddate,"dd-MMM-yyyy hh:mm a")," "),t.xp6(2),t.Q6J("ngIf",a.EditButtonEnable(e.createddate)),t.xp6(1),t.Q6J("ngIf",a.EditButtonEnable(e.createddate)),t.xp6(4),t.Q6J("ngModel",a.editmessage)}}function E(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td",51)(2,"div",52),t._uU(3),t.qZA()(),t.TgZ(4,"td",53),t._uU(5),t.ALo(6,"date"),t.qZA()()),2&n){const e=r.$implicit;t.xp6(3),t.hij(" ",e.createdby," "),t.xp6(2),t.Oqu(t.xi3(6,2,e.createddate,"dd/MM/yy hh:mm a"))}}function w(n,r){if(1&n&&(t.TgZ(0,"div",44)(1,"div",45)(2,"h3",46),t._UZ(3,"i",47),t._uU(4," Read by"),t.qZA(),t.TgZ(5,"div",48)(6,"table",49)(7,"tbody"),t.YNc(8,E,7,5,"tr",50),t.qZA()()()()()),2&n){const e=t.oxw(3);t.xp6(8),t.Q6J("ngForOf",e.service.tenderreaddata)}}function y(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",14)(1,"div",54)(2,"div",34)(3,"button",35),t.NdJ("click",function(i){t.CHM(e);const o=t.oxw().$implicit,c=t.MAs(3),d=t.oxw(2);return c.toggle(i),t.KtG(d.service.ReadTenderChatbyid(o.id))}),t.O4$(),t.TgZ(4,"svg",36),t._UZ(5,"path",31)(6,"path",37)(7,"path",38)(8,"path",39),t.qZA()()(),t.kcU(),t.TgZ(9,"div",16)(10,"div",17)(11,"div",55)(12,"div",19)(13,"div",20)(14,"div",21),t._uU(15),t.qZA(),t._UZ(16,"div",22),t.qZA()(),t.TgZ(17,"div",23),t._UZ(18,"div",24),t.qZA(),t.TgZ(19,"div",19)(20,"div",20),t._UZ(21,"div",21),t.TgZ(22,"div",22),t._uU(23),t.ALo(24,"date"),t.qZA()()()()()()()()}if(2&n){const e=t.oxw().$implicit;t.xp6(15),t.AsE("",e.createdby," (",e.header,")"),t.xp6(3),t.Q6J("innerText",e.text),t.xp6(5),t.hij("",t.xi3(24,4,e.createddate,"dd-MMM-yyyy hh:mm a")," ")}}const A=()=>({width:"450px"});function k(n,r){if(1&n&&(t.TgZ(0,"div",10),t.YNc(1,Z,37,10,"div",11),t.TgZ(2,"p-overlayPanel",null,12),t.YNc(4,w,9,1,"ng-template",13),t.qZA(),t.YNc(5,y,25,7,"div",11),t.qZA()),2&n){const e=r.$implicit,a=t.oxw(2);t.xp6(1),t.um2(1,e.email==a.user?1:-1),t.xp6(1),t.Akn(t.DdM(4,A)),t.xp6(3),t.um2(5,e.email!=a.user?5:-1)}}function U(n,r){if(1&n&&(t.TgZ(0,"div",9),t.SjG(1,k,6,5,"div",56,t.x6l),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.wJu(e.service.tenderchatlist)}}function O(n,r){1&n&&(t.TgZ(0,"h2",8),t._uU(1,"No Chat"),t.qZA())}function D(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.SendMessage())}),t.O4$(),t.TgZ(1,"svg",30),t._UZ(2,"path",31)(3,"path",32)(4,"path",33),t.qZA()()}}let F=(()=>{class n{constructor(e,a,i,o){this.service=e,this.imageservice=a,this.toast=i,this.userservice=o,this.user=this.userservice.GetUserName(),this.isadmin=!1,this.emoji=!1,this.sendbutton=!1,this.editmessage=""}ngOnInit(){"Admin"==this.userservice.GetRole()&&(this.isadmin=!0)}addEmoji(e){this.service.tenderchatdata.text=this.service.tenderchatdata.text?this.service.tenderchatdata.text+e.emoji.native:e.emoji.native}OpenEmoji(){this.emoji=!this.emoji}onCtrlEnter(){this.service.tenderchatdata.text+="\n"}onEditCtrlEnter(){this.editmessage+="\n"}EditButtonEnable(e){return Math.floor((+new Date-+new Date(e))/1e3)<1800}EnableSendButton(){this.sendbutton=1!=/^\s+$/.test(this.service.tenderchatdata.text)&&!!this.service.tenderchatdata.text}DeleteChat(e){1==confirm("Do You want Sure to Delete Chat?")&&this.service.DeleteChatbyid(e).subscribe(a=>{"success"==a.status?(this.toast.success(a.message,"Success"),this.service.Chatbyid(this.service.tenderchatid)):this.toast.warning(a.message,"Warning")})}SendMessage(){this.service.tenderchatdata.text?1==/^\s+$/.test(this.service.tenderchatdata.text)?this.toast.warning("Blank Message Can't to be Send","Warning"):1==this.sendbutton&&(this.sendbutton=!1,this.service.tenderchatdata.uid=this.service.tenderchatid,this.service.tenderchatdata.email=this.userservice.GetUserName(),this.service.tenderchatdata.createdby=this.userservice.GetFullName(),this.service.tenderchatdata.createddate=this.gettime(),this.service.TenderChat().pipe((0,m.x)()).subscribe(e=>{"success"==e.status?(this.toast.success(e.message,"Success"),this.service.Chatbyid(this.service.tenderchatid),this.service.tenderchatdata.text=""):this.toast.warning(e.message,"Warning")})):this.toast.warning("Blank Message Can't to be Send","Warning")}EditChat(e){this.editmessage=e.text,this.editid=e.id}EditMessage(){this.service.tenderchatdata.id=this.editid,this.service.tenderchatdata.text=this.editmessage,this.service.TenderChat().subscribe(e=>{"success"==e.status?(this.toast.success(e.message,"Success"),this.service.Chatbyid(this.service.tenderchatid),this.service.tenderchatdata.text=""):this.toast.warning(e.message,"Warning")})}gettime(){let e=new Date,i=e.getTime()+Math.abs(6e4*e.getTimezoneOffset());return new Date(i).toISOString()}static#t=this.\u0275fac=function(a){return new(a||n)(t.Y36(g.$),t.Y36(v.D),t.Y36(x._W),t.Y36(C.K))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-tenderchat"]],standalone:!0,features:[t.jDz],decls:9,vars:4,consts:[["id","chat-window",1,"card-body","scrollable",2,"height","26rem"],["class","text-center text-danger",4,"ngIf"],["class","chat"],[1,"card-footer"],[1,"input-group","input-group-flat"],["rows","4","autocomplete","off","placeholder","Type a message",1,"form-control",3,"ngModel","input","ngModelChange","keydown.control.enter","keydown.enter"],[1,"input-group-text"],["type","button","class","btn-link link-secondary ms-2","title","Send Message",3,"click",4,"ngIf"],[1,"text-center","text-danger"],[1,"chat"],[1,"chat-bubbles"],["class","chat-item"],["readtoggle",""],["pTemplate","content"],[1,"chat-item"],[1,"row","align-items-end","justify-content-end"],[1,"col","col-lg-10"],[1,"mb-3"],[1,"chat-bubble","chat-bubble-me"],[1,"chat-bubble-title"],[1,"row","strong"],[1,"col","chat-bubble-author"],[1,"col-auto","chat-bubble-date"],[1,"chat-bubble-body"],[3,"innerText"],["type","button","class","btn-link",3,"click",4,"ngIf"],["type","button","class","btn-link text-danger",3,"click",4,"ngIf"],["edittoggle",""],["rows","4","autocomplete","off","placeholder","Type a message",1,"form-control",3,"ngModel","ngModelChange","keydown.control.enter","keydown.enter"],["type","button","title","Send Message",1,"btn-link","link-secondary","ms-2",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor","fill","none","stroke-linecap","round","stroke-linejoin","round",1,"icon","icon-tabler","icon-tabler-send"],["stroke","none","d","M0 0h24v24H0z","fill","none"],["d","M10 14l11 -11"],["d","M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5"],[1,"col-auto"],["type","button",1,"btn","btn-icon",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor","fill","none","stroke-linecap","round","stroke-linejoin","round",1,"icon","icon-tabler","icon-tabler-alert-circle"],["d","M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"],["d","M12 8v4"],["d","M12 16h.01"],["type","button",1,"btn-link",3,"click"],[1,"fa","fa-edit"],["type","button",1,"btn-link","text-danger",3,"click"],[1,"fa","fa-trash"],[1,"row","row-cards"],[1,"col-12"],[1,"text-primary"],[1,"fa","fa-check-double"],[1,"card-table","table-responsive"],[1,"table","table-vcenter"],[4,"ngFor","ngForOf"],[1,"td-truncate"],[1,"text-truncate"],[1,"text-nowrap","text-secondary"],[1,"row","align-items-end"],[1,"chat-bubble"],["class","chat-bubbles"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0),t.YNc(1,b,2,0,"h2",1)(2,U,3,0,"div",2)(3,O,2,0),t.qZA(),t.TgZ(4,"div",3)(5,"div",4)(6,"textarea",5),t.NdJ("input",function(){return i.EnableSendButton()})("ngModelChange",function(c){return i.service.tenderchatdata.text=c})("keydown.control.enter",function(){return i.onCtrlEnter()})("keydown.enter",function(){return i.SendMessage()}),t.qZA(),t.TgZ(7,"span",6),t.YNc(8,D,5,0,"button",7),t.qZA()()()),2&a&&(t.xp6(1),t.Q6J("ngIf",0==i.service.tenderchatlist.length),t.xp6(1),t.um2(2,i.service.tenderchatlist?2:3),t.xp6(4),t.Q6J("ngModel",i.service.tenderchatdata.text),t.xp6(2),t.Q6J("ngIf",i.sendbutton))},dependencies:[_.ez,_.sg,_.O5,_.uU,l.u5,l.Fj,l.JJ,l.On,u.y,u.T,T.jx,p.ne]})}return n})()}}]);