"use strict";(self.webpackChunkintranet=self.webpackChunkintranet||[]).push([[3891],{3891:(T,d,a)=>{a.r(d),a.d(d,{CreateorderComponent:()=>C});var u=a(6814),n=a(6223),t=a(9212),h=a(9862);let v=(()=>{class s{constructor(e){this.http=e}GetCustomer(){return this.http.get("https://localhost:7118/Customer/GetAll")}GetCustomerbycode(e){return this.http.get("https://localhost:7118/Customer/GetByCode?Code="+e)}GetProducts(){return this.http.get("https://localhost:7118/Product/GetAll")}GetProductbycode(e){return this.http.get("https://localhost:7118/Product/GetByCode?Code="+e)}GetAllInvoice(){return this.http.get("https://localhost:7118/Invoice/GetAllHeader")}GetInvHeaderbycode(e){return this.http.get("https://localhost:7118/Invoice/GetAllHeaderbyCode?invoiceno="+e)}GetInvDetailbycode(e){return this.http.get("https://localhost:7118/Invoice/GetAllDetailbyCode?invoiceno="+e)}RemoveInvoice(e){return this.http.delete("https://localhost:7118/Invoice/Remove?invoiceno="+e)}SaveInvoice(e){return this.http.post("https://localhost:7118/Invoice/Save",e)}GenerateInvoicePDF(e){return this.http.get("https://localhost:7118/Invoice/generatepdf?InvoiceNo="+e,{observe:"response",responseType:"blob"})}static#t=this.\u0275fac=function(r){return new(r||s)(t.LFG(h.eN))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var m=a(266),p=a(2425),g=a(5633);function f(s,c){if(1&s&&(t.TgZ(0,"option",36),t._uU(1),t.qZA()),2&s){const e=c.$implicit;t.Q6J("value",e.code),t.xp6(1),t.hij(" ",e.name," ")}}function Z(s,c){if(1&s&&(t.TgZ(0,"option",36),t._uU(1),t.qZA()),2&s){const e=c.$implicit;t.Q6J("value",e.code),t.xp6(1),t.hij(" ",e.name," ")}}function b(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"tr",37)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"select",38),t.NdJ("change",function(){const i=t.CHM(e).index,l=t.oxw();return t.KtG(l.productchange(i))}),t.YNc(5,Z,2,2,"option",19),t.qZA()(),t.TgZ(6,"td"),t._UZ(7,"input",39),t.qZA(),t.TgZ(8,"td")(9,"input",40),t.NdJ("keyup",function(){const i=t.CHM(e).index,l=t.oxw();return t.KtG(l.Itemcalculation(i))}),t.qZA()(),t.TgZ(10,"td")(11,"input",41),t.NdJ("keyup",function(){const i=t.CHM(e).index,l=t.oxw();return t.KtG(l.Itemcalculation(i))}),t.qZA()(),t.TgZ(12,"td"),t._UZ(13,"input",31),t.qZA(),t.TgZ(14,"td")(15,"a",42),t.NdJ("click",function(){const i=t.CHM(e).index,l=t.oxw();return t.KtG(l.Removeproduct(i))}),t._uU(16,"Remove"),t.qZA()()()}if(2&s){const e=c.index,r=t.oxw();t.Q6J("formGroupName",e),t.xp6(2),t.Oqu(e+1),t.xp6(3),t.Q6J("ngForOf",r.masterproduct)}}let C=(()=>{class s{constructor(e,r,o,i,l,_){this.builder=e,this.service=r,this.router=o,this.alert=i,this.activeroute=l,this.userservice=_,this.pagetitle="Create Invoice",this.isedit=!1,this.p=1,this.invoiceform=this.builder.group({invoiceNo:this.builder.control("",n.kI.required),customerId:this.builder.control("",n.kI.required),customerName:this.builder.control(""),deliveryAddress:this.builder.control(""),remarks:this.builder.control(""),total:this.builder.control({value:0,disabled:!0}),tax:this.builder.control({value:0,disabled:!0}),netTotal:this.builder.control({value:0,disabled:!0}),details:this.builder.array([])})}ngOnInit(){this.editid=this.activeroute.snapshot.paramMap.get("id"),console.log(this.editid),null!=this.editid&&(this.pagetitle="Edit Invoice",this.isedit=!0,this.SetEditInfo(this.editid))}SetEditInfo(e){this.service.GetInvDetailbycode(e).subscribe(r=>{this.editinvdetail=r;for(let o=0;o<this.editinvdetail.length;o++)this.addnewproduct()}),this.service.GetInvHeaderbycode(e).subscribe(r=>{let o;o=r,null!=o&&this.invoiceform.setValue({invoiceNo:o.invoiceNo,customerId:o.customerId,customerName:o.customerName,deliveryAddress:o.deliveryAddress,remarks:o.remarks,total:o.total,tax:o.tax,netTotal:o.netTotal,details:this.editinvdetail})})}SaveInvoice(){this.invoiceform.valid?this.service.SaveInvoice(this.invoiceform.getRawValue()).subscribe(e=>{let r;r=e,"pass"==r.result?(this.alert.success(this.isedit?"Updated Successfully.":"Created Successfully.","Invoice :"+r.kyValue),this.router.navigate(["/"])):this.alert.error("Failed to save.","Invoice")}):this.alert.warning("Please enter values in all mandatory field","Validation")}addnewproduct(){this.invoicedetail=this.invoiceform.get("details");let e=this.invoiceform.get("customerId")?.value;null!=e&&""!=e||this.isedit?this.invoicedetail.push(this.Generaterow()):this.alert.warning("Please select the customer","Validation")}get invproducts(){return this.invoiceform.get("details")}Generaterow(){return this.builder.group({invoiceNo:this.builder.control(""),productCode:this.builder.control("",n.kI.required),productName:this.builder.control(""),qty:this.builder.control(1),salesPrice:this.builder.control(0),total:this.builder.control({value:0,disabled:!0})})}GetCustomers(){this.service.GetCustomer().subscribe(e=>{this.mastercustomer=e})}GetProducts(){this.service.GetProducts().subscribe(e=>{this.masterproduct=e})}customerchange(){let e=this.invoiceform.get("customerId")?.value;this.service.GetCustomerbycode(e).subscribe(r=>{let o;o=r,null!=o&&(this.invoiceform.get("deliveryAddress")?.setValue(o.address+","+o.phoneno+","+o.email),this.invoiceform.get("customerName")?.setValue(o.name))})}productchange(e){this.invoicedetail=this.invoiceform.get("details"),this.invoiceproduct=this.invoicedetail.at(e);let r=this.invoiceproduct.get("productCode")?.value;this.service.GetProductbycode(r).subscribe(o=>{let i;i=o,console.log(i),null!=i&&(this.invoiceproduct.get("productName")?.setValue(i.name),this.invoiceproduct.get("salesPrice")?.setValue(i.price),this.Itemcalculation(e))})}Itemcalculation(e){this.invoicedetail=this.invoiceform.get("details"),this.invoiceproduct=this.invoicedetail.at(e);let r=this.invoiceproduct.get("qty")?.value,o=this.invoiceproduct.get("salesPrice")?.value,i=r*o;this.invoiceproduct.get("total")?.setValue(i),this.summarycalculation()}Removeproduct(e){confirm("Do you want to remove?")&&(this.invproducts.removeAt(e),this.summarycalculation())}summarycalculation(){let e=this.invoiceform.getRawValue().details,r=0;e.forEach(l=>{r+=l.total});let o=.07*r,i=r+o;this.invoiceform.get("total")?.setValue(r),this.invoiceform.get("tax")?.setValue(o),this.invoiceform.get("netTotal")?.setValue(i)}static#t=this.\u0275fac=function(r){return new(r||s)(t.Y36(n.qu),t.Y36(v),t.Y36(m.F0),t.Y36(p._W),t.Y36(m.gz),t.Y36(g.K))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-createorder"]],standalone:!0,features:[t.jDz],decls:90,vars:3,consts:[[1,"page-header","d-print-none"],[1,"container-xl"],[1,"row","g-2","align-items-center"],[1,"col"],[1,"page-pretitle"],[1,"page-title"],[1,"col-auto","ms-auto","d-print-none"],[1,"btn-list"],[1,"page-body"],[1,"card","card-lg"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"row","row-cards"],[1,"col-md-6"],[1,"mb-3"],[1,"form-label","required"],["formControlName","invoiceNo",1,"form-control"],["formControlName","customerId",1,"form-select",3,"change"],["value","210"],[3,"value",4,"ngFor","ngForOf"],["formControlName","deliveryAddress",1,"form-control"],[1,"form-label"],["formControlName","remarks",1,"form-control"],[1,"col-md-12"],["formArrayName","details",1,"table","table-bordered"],[1,"bg-primary","text-white"],[2,"width","20%"],[3,"formGroupName",4,"ngFor","ngForOf"],["colspan","6"],[1,"btn","btn-success",3,"click"],[1,"col-md-4"],["formControlName","total",1,"form-control"],["formControlName","tax",1,"form-control"],["formControlName","netTotal",1,"form-control"],["type","submit",1,"btn","btn-success"],["routerLink","/saleorder",1,"btn","btn-danger"],[3,"value"],[3,"formGroupName"],["formControlName","productCode",1,"form-select",3,"change"],["formControlName","productName",1,"form-control"],["formControlName","qty",1,"form-control",3,"keyup"],["formControlName","salesPrice",1,"form-control",3,"keyup"],[1,"btn","btn-danger",3,"click"]],template:function(r,o){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),t._uU(5," Overview "),t.qZA(),t.TgZ(6,"h2",5),t._uU(7," Sale Order "),t.qZA()(),t.TgZ(8,"div",6),t._UZ(9,"div",7),t.qZA()()()(),t.TgZ(10,"div",8)(11,"div",1)(12,"div",9)(13,"div",10)(14,"form",11),t.NdJ("ngSubmit",function(){return o.SaveInvoice()}),t.TgZ(15,"div",12)(16,"div",13)(17,"div",14)(18,"label",15),t._uU(19,"Invoice No"),t.qZA(),t._UZ(20,"input",16),t.qZA()(),t.TgZ(21,"div",13)(22,"div",14)(23,"label",15),t._uU(24,"Customer"),t.qZA(),t.TgZ(25,"select",17),t.NdJ("change",function(){return o.customerchange()}),t.TgZ(26,"option",18),t._uU(27,"GUPTA TRADERS"),t.qZA(),t.YNc(28,f,2,2,"option",19),t.qZA()()(),t.TgZ(29,"div",13)(30,"div",14)(31,"label",15),t._uU(32,"Address"),t.qZA(),t._UZ(33,"textarea",20),t.qZA()(),t.TgZ(34,"div",13)(35,"div",14)(36,"label",21),t._uU(37,"Remarks"),t.qZA(),t._UZ(38,"textarea",22),t.qZA()()(),t._UZ(39,"br"),t.TgZ(40,"div",12)(41,"div",23)(42,"table",24)(43,"thead",25)(44,"tr")(45,"td"),t._uU(46,"S.No"),t.qZA(),t.TgZ(47,"td",26),t._uU(48,"Product Code"),t.qZA(),t.TgZ(49,"td"),t._uU(50,"Description"),t.qZA(),t.TgZ(51,"td"),t._uU(52,"Qty"),t.qZA(),t.TgZ(53,"td"),t._uU(54,"Price"),t.qZA(),t.TgZ(55,"td"),t._uU(56,"Total"),t.qZA(),t.TgZ(57,"td"),t._uU(58,"Action"),t.qZA()()(),t.TgZ(59,"tbody"),t.YNc(60,b,17,3,"tr",27),t.qZA(),t.TgZ(61,"tfoot")(62,"tr")(63,"td",28)(64,"a",29),t.NdJ("click",function(){return o.addnewproduct()}),t._uU(65,"[+]"),t.qZA()()()()()()(),t._UZ(66,"br"),t.TgZ(67,"div",12)(68,"div",30)(69,"div",14)(70,"label"),t._uU(71,"Summary Total"),t.qZA(),t._UZ(72,"input",31),t.qZA()(),t.TgZ(73,"div",30)(74,"div",14)(75,"label"),t._uU(76,"Summary Tax"),t.qZA(),t._UZ(77,"input",32),t.qZA()(),t.TgZ(78,"div",30)(79,"div",14)(80,"label"),t._uU(81,"Summary NetTotal"),t.qZA(),t._UZ(82,"input",33),t.qZA()(),t.TgZ(83,"div",23),t._UZ(84,"br"),t.TgZ(85,"button",34),t._uU(86,"Save"),t.qZA(),t._uU(87," | "),t.TgZ(88,"a",35),t._uU(89,"Back"),t.qZA()()()()()()()()),2&r&&(t.xp6(14),t.Q6J("formGroup",o.invoiceform),t.xp6(14),t.Q6J("ngForOf",o.mastercustomer),t.xp6(32),t.Q6J("ngForOf",o.invproducts.controls))},dependencies:[u.ez,u.sg,n.u5,n._Y,n.YN,n.Kr,n.Fj,n.EJ,n.JJ,n.JL,n.UX,n.sg,n.u,n.x0,n.CE]})}return s})()}}]);